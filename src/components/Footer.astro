---
import { Icon } from 'astro-icon/components';
import siteInfo from '~/data/site-info.js';
import SocialLinks from './SocialLinks.astro';
import HexaGlueLogo from './HexaGlueLogo.astro';

interface Props {
	bgClass?: string;
}

const { bgClass = 'bg-dark' } = Astro.props;

type Link = {
	href: string;
	label: string;
};

type LinkGroup = {
	title: string;
	links: Link[];
};

const groups: LinkGroup[] = [
	{
		title: 'Produit',
		links: [
			{ label: 'Fonctionnalités', href: '/features/' },
			{ label: 'Pour les décideurs', href: '/for/decision-makers/' },
			{ label: 'Pour les architectes', href: '/for/architects/' },
			{ label: 'Pour les tech leads', href: '/for/tech-leads/' },
		],
	},
	{
		title: 'Documentation',
		links: [
			{ label: 'Guides', href: '/guides/' },
			{ label: 'Démarrage rapide', href: '/docs/getting-started/' },
			{ label: 'Guide DDD', href: '/guides/ddd-principles/' },
			{ label: 'Guide Hexagonal', href: '/guides/hexagonal-architecture/' },
			{ label: 'Plugin Audit', href: '/docs/plugin-audit/' },
			{ label: 'Plugin JPA', href: '/docs/plugin-jpa/' },
			{ label: 'Plugin Living Doc', href: '/docs/plugin-living-doc/' },
			{ label: 'GitHub', href: 'https://github.com/hexaglue/hexaglue' },
		],
	},
	{
		title: 'Études de cas',
		links: [
			{ label: 'Vue d\'ensemble', href: '/case-studies/' },
			{ label: 'Migration E-Commerce', href: '/case-studies/ecommerce-migration/' },
			{ label: 'Migration Bancaire', href: '/case-studies/banking-migration/' },
			{ label: 'Exemples de code', href: 'https://github.com/hexaglue/hexaglue/tree/main/examples' },
		],
	},
	{
		title: 'Entreprise',
		links: [
			{ label: 'Services', href: '/services/' },
			{ label: 'Contact', href: '/contact/' },
		],
	},
	{
		title: 'Communauté',
		links: [
			{ label: 'GitHub Discussions', href: 'https://github.com/hexaglue/hexaglue/discussions' },
			{ label: 'Contribuer', href: 'https://github.com/hexaglue/hexaglue/blob/main/CONTRIBUTING.md' },
		],
	},
];

const socialLinks = siteInfo.socialLinks;
---

<footer class:list={['w-full border-t border-astro-dark-100/20 relative z-10', bgClass]}>
	<div class="w-full max-w-screen-2xl mx-auto px-4 sm:px-8">
		<nav
			aria-label="Secondary"
			class="flex flex-col lg:flex-row justify-between gap-8 lg:gap-12 py-8 md:py-12"
		>
			<div class="flex flex-col gap-4 w-full lg:max-w-sm text-center lg:text-left items-center lg:items-start">
				<a href="/" data-astro-prefetch title="Accueil">
					<HexaGlueLogo aria-hidden="true" loading="lazy" />
				</a>
				<p class="text-astro-gray-300 text-base font-bold">
					L'Architecture as Code. Enfin.
				</p>
			</div>

			<div class="grid grid-cols-2 gap-x-6 gap-y-8 sm:grid-cols-3 sm:gap-x-10 xl:grid-cols-5 xl:gap-x-8 w-full lg:flex-1 lg:min-w-0">
				{
					groups.map(({ title, links }, index) => (
						<section class="group flex flex-col">
							<h2
								id={`footerHeading${index}`}
								class="mb-4 label-base leading-none text-white font-semibold"
							>
								{title}
							</h2>
							<ul aria-labelledby={`footerHeading${index}`} class="flex flex-col gap-2">
								{links.map(({ href, label }) => {
									const isExternal = href.startsWith('http://') || href.startsWith('https://');
									return (
										<li>
											<a
												href={href}
												target={isExternal ? '_blank' : undefined}
												rel={isExternal ? 'noopener noreferrer' : undefined}
												class="link flex gap-2 items-center"
											>
												{label}
												{isExternal && <Icon name="ri/external-link-line" class="size-3 shrink-0 opacity-50" aria-hidden="true" />}
											</a>
										</li>
									);
								})}
							</ul>
						</section>
					))
				}
			</div>
		</nav>
		<hr class="border-astro-gray-500" />
		<nav
			aria-label="Legal"
			class="py-6 flex flex-col-reverse lg:flex-row items-center justify-between gap-4"
		>
			<div class="flex flex-col md:flex-row items-center gap-2 md:gap-6 text-base text-astro-gray-300">
				<span>© {new Date().getFullYear()} Scalastic</span>
				<span>Publié sous licence <a href="https://github.com/hexaglue/hexaglue/blob/main/LICENSE" target="_blank" rel="noopener noreferrer" class="link">MPL-2.0</a></span>
				<span>Propulsé par <a href="https://astro.build" target="_blank" rel="noopener noreferrer" class="link">Astro</a></span>
			</div>
			<SocialLinks links={socialLinks} />
		</nav>
	</div>
</footer>
