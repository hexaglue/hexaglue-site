---
import { Icon } from 'astro-icon/components';
import siteInfo from '~/data/site-info.js';
import SocialLinks from './SocialLinks.astro';

const nav: Nav = [
	{
		label: 'Ressources',
		items: [
			{ href: '/getting-started/', label: 'Documentation', icon: 'file-alt', prefetch: true },
			{ href: 'https://github.com/hexaglue/hexaglue/tree/main/examples', label: 'Exemples', icon: 'ri/code-box-line' },
			{ href: 'https://github.com/hexaglue/hexaglue', label: 'GitHub', icon: 'logos/github' },
		],
	},
	{
		label: 'Entreprise',
		items: [
			{ href: '/case-studies/', label: 'Etude de cas', icon: 'file-alt', prefetch: true },
			{ href: '/contact/', label: 'Contact', icon: 'email', prefetch: true },
		],
	},
	{
		label: 'Communaut√©',
		items: [
			{ href: 'https://github.com/hexaglue/hexaglue/discussions', label: 'GitHub Discussions', icon: 'logos/github' },
			{ href: 'https://github.com/hexaglue/hexaglue/blob/main/CONTRIBUTING.md', label: 'Contribuer', icon: 'ri/code-s-slash-line' },
		],
	},
];

interface Link {
	href: string;
	label: string;
	prefetch?: true;
}
interface GroupLink extends Link {
	icon: string;
	badge?: string;
}
interface Group {
	label: string;
	items: GroupLink[];
}
type Nav = Array<Link | Group>;
---

<nav
	aria-label="Primary"
	class="text-xl flex flex-col divide-y divide-astro-gray-500 pb-12 text-left [&>*]:p-6"
>
	{
		nav.map((item) =>
			'href' in item ? (
				// Top-level link
				<a
					class="link"
					href={item.href}
					data-astro-prefetch={item.prefetch ? '' : undefined}
					set:text={item.label}
				/>
			) : (
				// Drop-down group
				<details class="group">
					<summary class="accordion link flex cursor-pointer list-none items-center justify-between">
						{item.label}
						<Icon
							name="chevron"
							aria-hidden="true"
							class="inline-block size-3 rotate-0 transition-transform group-open:-rotate-180 duration-300"
						/>
					</summary>
					<div class="mt-4 flex flex-col gap-4 text-xl font-light">
						{item.items.map((link) => (
							<a
								href={link.href}
								data-astro-prefetch={link.prefetch ? '' : undefined}
								class="link flex items-center gap-4"
							>
								<Icon name={link.icon} size="24" /> {link.label}{' '}
								{link.badge && (
									<span class="text-sm leading-none font-mono py-1 px-1.5 rounded bg-astro-blue/40 border border-astro-blue">
										{link.badge}
									</span>
								)}
							</a>
						))}
					</div>
				</details>
			),
		)
	}

	<div class="flex flex-wrap justify-between gap-12 gap-y-6">
		<SocialLinks links={siteInfo.socialLinks} />
		<a href="/getting-started/" class="button button-primary flex-grow sm:max-w-sm">
			Lire la documentation
		</a>
	</div>
</nav>
