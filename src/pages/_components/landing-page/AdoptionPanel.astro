---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';
import GemIcon from '~/components/GemIcon.astro';

interface Props {
	id: string;
	icon: string;
	gradient?: 'blue-purple' | 'blue-green' | 'red-pink' | 'orange-yellow';
	title: string;
	image?: ImageMetadata;
	imageAlt?: string;
	imagePosition?: 'left' | 'right';
}

const { id, icon, gradient = 'blue-purple', title, image, imageAlt, imagePosition = 'right' } = Astro.props;
const isImageLeft = imagePosition === 'left';
---

<div
	id={`adoption-panel-${id}`}
	class="scroll-reveal adoption-panel"
>
	<div
		class="p-6 sm:p-8 bg-astro-dark-800/40 border border-astro-purple/15 rounded-xl"
	>
		<div class:list={[image && 'flex flex-col lg:items-center gap-6 lg:gap-10', image && (isImageLeft ? 'lg:flex-row-reverse' : 'lg:flex-row')]}>
			<div class:list={['flex flex-col md:flex-row md:items-start gap-6', image && 'flex-1']}>
				<GemIcon icon={icon} gradient={gradient} />

				<div class="flex-1">
					<h3 class="text-xl font-semibold text-white">{title}</h3>
					<div class="panel-description mt-3 text-astro-gray-200 font-light text-base">
						<slot />
					</div>
				</div>
			</div>

			{image && (
				<div class:list={['adoption-panel-image lg:w-[45%] lg:shrink-0 h-80 sm:h-96 lg:h-[34rem]', isImageLeft ? 'from-left' : 'from-right']}>
					<Image
						src={image}
						alt={imageAlt ?? ''}
						widths={[400, 600, 800]}
						sizes="(max-width: 1024px) 100vw, 45vw"
						class="w-full h-full object-contain object-center rounded-xl shadow-2xl"
						loading="lazy"
					/>
				</div>
			)}
		</div>
	</div>
</div>

<style>
	.panel-description :global(strong) {
		@apply font-semibold text-white;
	}
	.panel-description :global(br) {
		@apply block mt-2;
	}
	.panel-description :global(ul) {
		@apply list-disc list-inside mt-2 space-y-1 text-astro-gray-100 font-normal;
	}

	.scroll-reveal {
		opacity: 0;
		transform: translateY(40px);
		transition: opacity 800ms cubic-bezier(0.22, 0.61, 0.36, 1),
			transform 800ms cubic-bezier(0.22, 0.61, 0.36, 1);
	}

	.scroll-reveal.is-visible {
		opacity: 1;
		transform: translateY(0);
	}

	.adoption-panel-image :global(img) {
		opacity: 0;
		transition: opacity 600ms ease-out 200ms, transform 700ms cubic-bezier(0.22, 0.61, 0.36, 1) 200ms;
	}

	.adoption-panel-image.from-right :global(img) {
		transform: translateX(30px);
	}

	.adoption-panel-image.from-left :global(img) {
		transform: translateX(-30px);
	}

	.scroll-reveal.is-visible .adoption-panel-image :global(img) {
		opacity: 1;
		transform: translateX(0);
	}
</style>
