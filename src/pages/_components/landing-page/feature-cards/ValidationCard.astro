---
import FeatureCard from './FeatureCard.astro';
---

<FeatureCard
	icon="ri/shield-check-line"
	title="Validation au Build-time"
	description="Capture les violations d'architecture avant les déploiements avec l'intégration d'un plugin Maven."
>
	<div slot="illustration" class="validation-illustration mt-4 pt-4 border-t border-astro-dark-100/10">
		<!-- Dot pattern background -->
		<div class="dot-pattern absolute inset-0"></div>
		<div class="pipeline-container relative h-16 flex items-center">
			<!-- Pipeline stages -->
			<div class="pipeline flex items-center w-full justify-between">
				<!-- Stage 1: Build -->
				<div class="stage stage-1">
					<div class="stage-icon"></div>
					<span class="stage-label">Build</span>
				</div>

				<!-- Arrow 1 -->
				<div class="arrow arrow-1">
					<div class="arrow-line"></div>
					<div class="arrow-flow"></div>
				</div>

				<!-- Stage 2: Validate (with checkmark) -->
				<div class="stage stage-2 validate-stage">
					<div class="stage-icon">
						<svg class="check-icon" viewBox="0 0 20 20" fill="none">
							<path class="check-path" d="M5 10l4 4 6-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					</div>
					<span class="stage-label">Validate</span>
				</div>

				<!-- Arrow 2 -->
				<div class="arrow arrow-2">
					<div class="arrow-line"></div>
					<div class="arrow-flow"></div>
				</div>

				<!-- Stage 3: Deploy -->
				<div class="stage stage-3">
					<div class="stage-icon"></div>
					<span class="stage-label">Deploy</span>
				</div>
			</div>
		</div>
	</div>
</FeatureCard>

<style>
	.validation-illustration {
		position: relative;
		overflow: hidden;
	}

	.dot-pattern {
		background: radial-gradient(rgba(64, 222, 191, 0.25) 0.75px, transparent 0.75px);
		background-size: 8px 8px;
		opacity: 0.5;
		transition: opacity 0.5s ease-out;
	}

	:global(.group:hover) .dot-pattern {
		opacity: 0.9;
	}

	.pipeline-container {
		padding: 0 8px;
		position: relative;
		z-index: 1;
	}

	.pipeline {
		position: relative;
	}

	.stage {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 4px;
		z-index: 10;
	}

	.stage-icon {
		width: 24px;
		height: 24px;
		border-radius: 6px;
		background: rgba(107, 122, 171, 0.2);
		border: 1px solid rgba(107, 122, 171, 0.3);
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.3s ease-out;
	}

	.stage-label {
		font-size: 9px;
		color: rgba(255, 255, 255, 0.4);
		transition: all 0.3s ease-out;
	}

	.arrow {
		flex: 1;
		height: 2px;
		position: relative;
		margin: 0 4px;
		margin-bottom: 16px;
	}

	.arrow-line {
		position: absolute;
		inset: 0;
		background: rgba(107, 122, 171, 0.3);
		border-radius: 1px;
	}

	.arrow-flow {
		position: absolute;
		top: 0;
		left: 0;
		height: 100%;
		width: 0%;
		background: linear-gradient(90deg, rgba(64, 222, 191, 0.8), rgba(50, 69, 255, 0.8));
		border-radius: 1px;
		transition: width 0.4s ease-out;
	}

	/* Validate stage specific */
	.validate-stage .stage-icon {
		background: rgba(64, 222, 191, 0.1);
		border-color: rgba(64, 222, 191, 0.2);
	}

	.check-icon {
		width: 14px;
		height: 14px;
		color: rgba(64, 222, 191, 0.3);
		transition: all 0.3s ease-out;
	}

	.check-path {
		stroke-dasharray: 20;
		stroke-dashoffset: 20;
		transition: stroke-dashoffset 0.4s ease-out;
	}

	/* Hover animations */
	:global(.group:hover) .stage-1 .stage-icon {
		background: rgba(50, 69, 255, 0.3);
		border-color: rgba(50, 69, 255, 0.5);
		box-shadow: 0 0 12px rgba(50, 69, 255, 0.3);
	}

	:global(.group:hover) .arrow-1 .arrow-flow {
		width: 100%;
		transition-delay: 0.2s;
	}

	:global(.group:hover) .validate-stage .stage-icon {
		background: rgba(64, 222, 191, 0.3);
		border-color: rgba(64, 222, 191, 0.5);
		box-shadow: 0 0 12px rgba(64, 222, 191, 0.4);
		transform: scale(1.1);
		transition-delay: 0.5s;
	}

	:global(.group:hover) .check-icon {
		color: rgba(64, 222, 191, 1);
		transition-delay: 0.5s;
	}

	:global(.group:hover) .check-path {
		stroke-dashoffset: 0;
		transition-delay: 0.6s;
	}

	:global(.group:hover) .arrow-2 .arrow-flow {
		width: 100%;
		transition-delay: 0.8s;
	}

	:global(.group:hover) .stage-3 .stage-icon {
		background: rgba(188, 82, 238, 0.3);
		border-color: rgba(188, 82, 238, 0.5);
		box-shadow: 0 0 12px rgba(188, 82, 238, 0.3);
		transition-delay: 1s;
	}

	:global(.group:hover) .stage-label {
		color: rgba(255, 255, 255, 0.8);
	}

	:global(.group:hover) .stage-1 .stage-label {
		transition-delay: 0s;
	}

	:global(.group:hover) .stage-2 .stage-label {
		transition-delay: 0.5s;
	}

	:global(.group:hover) .stage-3 .stage-label {
		transition-delay: 1s;
	}
</style>
