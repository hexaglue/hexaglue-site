---
import FeatureCard from '~/components/FeatureCard.astro';
---

<FeatureCard
	icon="ri:layout-masonry-line"
	title="Clean Architecture"
	description="Supporte les patterns de la Clean architecture avec séparations des préoccupations."
	href="/guides/hexagonal-architecture/"
>
	<div slot="illustration" class="clean-arch-illustration mt-4 pt-4 border-t border-astro-dark-100/10">
		<div class="layers-container relative h-28 flex items-center justify-center">
			<!-- Layer 3: Infrastructure (outermost) -->
			<div class="layer layer-infra layer-3">
				<span class="layer-label">Infrastructure</span>
			</div>
			<!-- Layer 2: Application -->
			<div class="layer layer-app layer-2">
				<span class="layer-label">Application</span>
			</div>
			<!-- Layer 1: Domain (innermost) -->
			<div class="layer layer-domain layer-1">
				<span class="layer-label">Domain</span>
			</div>

			<!-- Dependency arrows pointing inward -->
			<svg class="arrows absolute inset-0 w-full h-full" viewBox="0 0 200 112" fill="none">
				<!-- Left arrow: Infra → App -->
				<path class="arrow arrow-left" d="M32 56 L58 56" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" marker-end="url(#arrowhead)" />
				<!-- Right arrow: App → Domain -->
				<path class="arrow arrow-right" d="M168 56 L142 56" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" marker-end="url(#arrowhead)" />
				<!-- Bottom arrow -->
				<path class="arrow arrow-bottom" d="M100 100 L100 80" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" marker-end="url(#arrowhead)" />
				<defs>
					<marker id="arrowhead" markerWidth="6" markerHeight="4" refX="5" refY="2" orient="auto">
						<path d="M0 0 L6 2 L0 4" fill="currentColor" />
					</marker>
				</defs>
			</svg>
		</div>
	</div>
</FeatureCard>

<style>
	.clean-arch-illustration {
		position: relative;
		overflow: hidden;
	}

	.layers-container {
		position: relative;
		z-index: 1;
	}

	/* Concentric layers */
	.layer {
		position: absolute;
		border-radius: 50%;
		display: flex;
		align-items: center;
		justify-content: center;
		transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
		opacity: 0.6;
	}

	.layer-label {
		font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Monaco, Consolas, monospace;
		font-size: 8px;
		white-space: nowrap;
		transition: all 0.3s ease-out;
		position: absolute;
	}

	/* Infrastructure - outermost */
	.layer-infra {
		width: 180px;
		height: 110px;
		background: rgba(188, 82, 238, 0.05);
		border: 1px solid rgba(188, 82, 238, 0.15);
		transform: scale(0.9);
	}

	.layer-infra .layer-label {
		color: rgba(188, 82, 238, 0.5);
		top: 4px;
		left: 50%;
		transform: translateX(-50%);
	}

	/* Application - middle */
	.layer-app {
		width: 120px;
		height: 72px;
		background: rgba(50, 69, 255, 0.05);
		border: 1px solid rgba(50, 69, 255, 0.15);
		transform: scale(0.9);
	}

	.layer-app .layer-label {
		color: rgba(50, 69, 255, 0.5);
		bottom: 2px;
		left: 50%;
		transform: translateX(-50%);
	}

	/* Domain - innermost */
	.layer-domain {
		width: 64px;
		height: 40px;
		background: rgba(64, 222, 191, 0.08);
		border: 1px solid rgba(64, 222, 191, 0.2);
		transform: scale(0.9);
	}

	.layer-domain .layer-label {
		color: rgba(64, 222, 191, 0.5);
	}

	/* Arrows */
	.arrows {
		z-index: 20;
		color: rgba(107, 122, 171, 0.2);
		transition: color 0.4s ease-out;
	}

	.arrow {
		stroke-dasharray: 40;
		stroke-dashoffset: 40;
		transition: stroke-dashoffset 0.4s ease-out;
	}

	/* Hover animations - layers light up inside-out */
	:global(.group:hover) .layer {
		opacity: 1;
		transform: scale(1);
	}

	:global(.group:hover) .layer-domain {
		background: rgba(64, 222, 191, 0.15);
		border-color: rgba(64, 222, 191, 0.5);
		box-shadow: 0 0 16px rgba(64, 222, 191, 0.25);
		transition-delay: 0ms;
	}

	:global(.group:hover) .layer-domain .layer-label {
		color: rgba(64, 222, 191, 1);
	}

	:global(.group:hover) .layer-app {
		background: rgba(50, 69, 255, 0.1);
		border-color: rgba(50, 69, 255, 0.4);
		box-shadow: 0 0 20px rgba(50, 69, 255, 0.15);
		transition-delay: 150ms;
	}

	:global(.group:hover) .layer-app .layer-label {
		color: rgba(129, 140, 248, 1);
	}

	:global(.group:hover) .layer-infra {
		background: rgba(188, 82, 238, 0.08);
		border-color: rgba(188, 82, 238, 0.4);
		box-shadow: 0 0 24px rgba(188, 82, 238, 0.12);
		transition-delay: 300ms;
	}

	:global(.group:hover) .layer-infra .layer-label {
		color: rgba(216, 180, 254, 1);
	}

	/* Arrows appear on hover */
	:global(.group:hover) .arrows {
		color: rgba(64, 222, 191, 0.7);
	}

	:global(.group:hover) .arrow {
		stroke-dashoffset: 0;
	}

	:global(.group:hover) .arrow-left {
		transition-delay: 400ms;
	}

	:global(.group:hover) .arrow-right {
		transition-delay: 500ms;
	}

	:global(.group:hover) .arrow-bottom {
		transition-delay: 600ms;
	}
</style>
