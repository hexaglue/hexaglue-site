---
import { Icon } from 'astro-icon/components';
import { Code } from 'astro-expressive-code/components';
import MainLayout from '~/layouts/MainLayout.astro';
import SectionCopy from '../_components/SectionCopy.astro';
import Link from '../_components/Link.astro';
import IntroPoint from '../_components/IntroPoint.astro';
import GemIcon from '~/components/GemIcon.astro';
import Insight from '~/components/Insight.astro';
import GreenishStardust from '../_components/landing-page/GreenishStardust.astro';

const yamlConfig = `# Configuration minimale pour démarrer
classification:
  exclude:
    - "com.acme.shop.config.*"

plugins:
  io.hexaglue.plugin.audit:
    failOnError: true           # Bloque le build sur violation CRITICAL
  io.hexaglue.plugin.livingdoc:
    outputFormat: "markdown"
  io.hexaglue.plugin.jpa:
    generateRepositories: true
    generateAdapters: true`;
---

<MainLayout
	title="HexaGlue pour les Tech Leads"
	description="HexaGlue génère l'infrastructure, documente le domaine et bloque les régressions architecturales dans la CI. Votre équipe se concentre sur le code qui compte : la logique métier."
	schema={{
		"@type": "WebPage",
		audience: { "@type": "Audience", audienceType: "Tech Lead, Lead Developer" },
	}}
>
	<!-- Hero Section -->
	<section class="pt-24 pb-16 md:pt-32 md:pb-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<GreenishStardust height="h-64 md:h-80" />

		<div class="text-center max-w-3xl mx-auto">
			<span class="bg-clip-text text-transparent bg-blue-green-gradient font-semibold text-sm uppercase tracking-wider">
				Pour les tech leads
			</span>

			<h1 class="mt-4 font-heading heading-bold text-4xl md:text-5xl lg:text-6xl text-white text-balance">
				Moins de câblage.<br/>
				<span class="bg-clip-text text-transparent bg-blue-green-gradient">Plus de logique métier.</span>
			</h1>

			<p class="mt-6 text-lg text-astro-gray-200 font-light max-w-2xl mx-auto text-balance">
				HexaGlue génère l'infrastructure, documente le domaine et bloque les régressions architecturales dans la CI. Votre équipe se concentre sur le code qui compte : la logique métier.
			</p>

			<div class="mt-8 flex justify-center">
				<Icon name="ri/code-s-slash-line" class="size-12 text-astro-gray-300/30" aria-hidden="true" />
			</div>
		</div>
	</section>

	<!-- Section 1 : Vos défis -->
	<section class="py-16 md:py-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<SectionCopy
			label="Contexte"
			title="Le boilerplate et les régressions freinent l'équipe"
		>
			Votre équipe passe du temps sur du code répétitif (entités JPA, mappers, repositories) et des régressions architecturales passent les revues. La documentation est toujours en retard sur le code.
		</SectionCopy>

		<div class="mt-10 grid grid-cols-1 gap-8 md:grid-cols-2 md:gap-12 lg:grid-cols-3">
			<IntroPoint tint="amber" title="Le code d'infrastructure est répétitif">
				<GemIcon slot="icon" icon="ri/file-copy-line" gradient="red-pink" />
				<Fragment slot="description">
					Pour chaque agrégat, il faut écrire l'entité JPA, le repository Spring Data, le mapper, l'adapter. Ce code est mécanique : il suit les mêmes patterns, avec les mêmes erreurs possibles. Il représente parfois plus de la moitié du code total d'un projet.
				</Fragment>
			</IntroPoint>

			<IntroPoint tint="amber" title="Les régressions architecturales passent inaperçues">
				<GemIcon slot="icon" icon="ri/bug-line" gradient="orange-yellow" />
				<Fragment slot="description">
					Un développeur pressé importe JPA dans le domaine. Un autre contourne un port pour appeler un repository directement. Ces raccourcis passent en revue parce qu'ils sont petits. Mais ils cassent l'isolation des couches et rendent le domaine difficile à tester.
				</Fragment>
			</IntroPoint>

			<IntroPoint tint="amber" title="La documentation est toujours en retard">
				<GemIcon slot="icon" icon="ri/draft-line" gradient="blue-purple" />
				<Fragment slot="description">
					Le wiki décrit l'architecture d'il y a 3 mois. Les nouveaux développeurs passent des jours à comprendre les agrégats, les ports et le câblage. Personne ne met à jour la documentation parce que tout le monde écrit du code.
				</Fragment>
			</IntroPoint>
		</div>
	</section>

	<!-- Section 2 : Comment HexaGlue vous aide -->
	<section class="py-16 md:py-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<SectionCopy
			label="Réponse"
			title="Un outil qui s'intègre dans votre workflow existant"
		>
			HexaGlue est un plugin Maven. Il s'ajoute au <code>pom.xml</code>, s'exécute à la compilation et produit du code, de la documentation et un rapport d'audit. Rien à changer dans votre workflow.
		</SectionCopy>

		<div class="mt-10 table-panel">
			<div class="table-panel-content max-w-4xl mx-auto overflow-x-auto">
				<table class="w-full text-sm text-left">
					<thead>
						<tr class="border-b border-astro-dark-100/20">
							<th class="py-3 pr-4 text-astro-gray-300 font-medium">Votre défi</th>
							<th class="py-3 text-astro-gray-300 font-medium">Ce que HexaGlue fournit</th>
						</tr>
					</thead>
					<tbody class="text-astro-gray-200">
						<tr class="border-b border-astro-dark-100/10">
							<td class="py-3 pr-4 font-medium text-white">Code répétitif</td>
							<td class="py-3"><strong class="text-white">Génération JPA</strong> : entités, repositories, mappers MapStruct et adapters de port générés automatiquement depuis le modèle de domaine. Dans l'étude de cas, 29 fichiers générés pour 8 agrégats</td>
						</tr>
						<tr class="border-b border-astro-dark-100/10">
							<td class="py-3 pr-4 font-medium text-white">Régressions silencieuses</td>
							<td class="py-3"><strong class="text-white">Audit en CI</strong> : les violations architecturales bloquent le build avec un message explicite. Le développeur sait immédiatement ce qui ne va pas et pourquoi</td>
						</tr>
						<tr>
							<td class="py-3 pr-4 font-medium text-white">Documentation en retard</td>
							<td class="py-3"><strong class="text-white">Living documentation</strong> : générée à chaque build depuis le code, elle liste les agrégats, entités, value objects, ports et leurs relations. Les nouveaux développeurs ont une cartographie à jour dès le premier jour</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>

		<div class="max-w-4xl mx-auto">
			<Insight variant="green">
				<p>HexaGlue s'exécute uniquement à la compilation. Il ne modifie pas le runtime, ne crée aucune dépendance transitive et ne change pas le comportement de l'application. Vous pouvez le retirer du <code>pom.xml</code> à tout moment : le code généré reste, le domaine n'est pas impacté.</p>
			</Insight>
		</div>
	</section>

	<!-- Section 3 : Intégration concrète -->
	<section class="py-16 md:py-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<SectionCopy
			label="En pratique"
			title="5 minutes pour l'ajouter à votre projet"
		>
			HexaGlue est un plugin Maven. Il s'ajoute au <code>pom.xml</code>, s'exécute à la compilation et produit du code, de la documentation et un rapport d'audit sans rien changer à votre workflow.
		</SectionCopy>

		<div class="mt-10 grid grid-cols-1 gap-8 md:grid-cols-2 md:gap-12 lg:grid-cols-3">
			<IntroPoint tint="green" title="1. Ajouter le plugin Maven">
				<GemIcon slot="icon" icon="ri/add-circle-line" gradient="blue-green" />
				<Fragment slot="description">
					Une section <code>&lt;plugin&gt;</code> dans le <code>pom.xml</code> avec les dépendances des plugins souhaités (audit, living-doc, JPA). HexaGlue détecte automatiquement le domaine.
				</Fragment>
			</IntroPoint>

			<IntroPoint tint="green" title="2. Compiler">
				<GemIcon slot="icon" icon="ri/terminal-box-line" gradient="orange-yellow" />
				<Fragment slot="description">
					<code>mvn clean compile</code> : HexaGlue classifie le domaine, génère l'infrastructure et produit la documentation. <code>mvn verify</code> : l'audit vérifie les règles d'architecture.
				</Fragment>
			</IntroPoint>

			<IntroPoint tint="green" title="3. Intégrer en CI">
				<GemIcon slot="icon" icon="ri/git-merge-line" gradient="blue-purple" />
				<Fragment slot="description">
					Ajouter <code>failOnError: true</code> dans <code>hexaglue.yaml</code> pour bloquer les builds avec des violations critiques. Le rapport d'audit est disponible dans <code>target/hexaglue/reports/</code>.
				</Fragment>
			</IntroPoint>
		</div>

		<div class="mt-10 max-w-4xl mx-auto">
			<Code code={yamlConfig} lang="yaml" title="hexaglue.yaml" />
		</div>

		<div class="max-w-4xl mx-auto">
			<Insight variant="amber">
				<p>L'étude de cas e-commerce part d'un monolithe Spring Boot de 50 classes avec 10 anti-patterns. En 7 étapes, l'architecture passe de 13/100 à 63/100. Le code source est sur GitHub, chaque étape est reproductible.</p>
			</Insight>
		</div>

		<div class="mt-6 max-w-4xl mx-auto">
			<a href="/docs/getting-started/" title="Reproduire le tutoriel" class="inline-flex items-center gap-2 text-astro-gray-200 hover:text-white transition-colors">
				<Icon name="ri/arrow-right-line" class="size-4" aria-hidden="true" />
				<span>Reproduire le tutoriel</span>
			</a>
		</div>
	</section>

	<!-- CTA Final -->
	<section class="py-16 md:py-24 mb-12 relative">
		<div class="w-full max-w-screen-xl mx-auto px-4 sm:px-8 text-center space-y-6">
			<h2 class="font-heading heading-bold text-3xl md:text-4xl lg:text-5xl text-white">
				<span class="text-astro-gray-300">Le câblage technique est automatisé.</span><br/>
				Votre équipe se concentre sur le métier.
			</h2>

			<p class="text-xl text-astro-gray-200 font-light max-w-2xl mx-auto">
				Voyez HexaGlue en action sur un projet réel ou ajoutez-le à votre build en 5 minutes.
			</p>

			<div class="pt-4 flex flex-col sm:flex-row items-center justify-center gap-4">
				<Link href="/docs/getting-started/" class="primary">
					Démarrer en 5 minutes
				</Link>
				<Link href="/case-studies/ecommerce-migration/" class="secondary">
					<Icon name="ri/book-open-line" class="size-5" aria-hidden="true" />
					<span>Voir une migration complète</span>
				</Link>
			</div>
		</div>
		<div
			class="absolute inset-x-0 bottom-0 h-[50vw] translate-y-[60%] bg-blue-green-gradient opacity-50 mask-radial-gradient pointer-events-none"
		></div>
	</section>
</MainLayout>

<style>
	code {
		@apply px-1.5 py-0.5 bg-astro-dark-600 rounded text-xs text-astro-gray-100;
		font-family: 'JetBrains Mono', ui-monospace, monospace;
	}
	.table-panel {
		position: relative;
		left: 50%;
		margin-left: -50vw;
		width: 100vw;
		padding: 2.5rem 1rem;
		border-top: 1px solid rgba(56, 189, 126, 0.07);
		border-bottom: 1px solid rgba(56, 189, 126, 0.07);
		background:
			radial-gradient(circle at 1px 1px, rgba(56, 189, 126, 0.12) 1px, transparent 0) 0 0 / 24px 24px,
			linear-gradient(180deg, rgba(56, 189, 126, 0.04) 0%, rgba(56, 189, 126, 0.02) 50%, rgba(56, 189, 126, 0.04) 100%);
	}
	.table-panel-content {
		background-color: #0e0d12;
		border: 1px solid rgba(56, 189, 126, 0.1);
		border-radius: 0.75rem;
		padding: 1.5rem;
		box-shadow:
			0 0 20px rgba(56, 189, 126, 0.12),
			0 0 50px rgba(56, 189, 126, 0.07),
			0 0 80px rgba(56, 189, 126, 0.04),
			0 1px 2px rgba(0, 0, 0, 0.4),
			0 4px 16px rgba(0, 0, 0, 0.3);
	}
</style>
