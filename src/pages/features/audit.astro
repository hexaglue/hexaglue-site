---
import { Icon } from 'astro-icon/components';
import { Image } from 'astro:assets';
import MainLayout from '~/layouts/MainLayout.astro';
import SectionCopy from '../_components/SectionCopy.astro';
import Link from '../_components/Link.astro';
import Insight from '~/components/Insight.astro';
import CompanionBanner from '~/components/CompanionBanner.astro';
import GreenishStardust from '../_components/landing-page/GreenishStardust.astro';
import BrowserFrame from '~/components/BrowserFrame.astro';
import auditScreenshot from '~/assets/screenshots/audit.png';
import auditVerdictWithBlockerScreenshot from '~/assets/screenshots/audit-verdict-with-blocker.png';
import auditKpiTableScreenshot from '~/assets/screenshots/audit-kpi-table.png';
import auditRadarChartScreenshot from '~/assets/screenshots/audit-radar-chart.png';
import audit20MetricsScreenshot from '~/assets/screenshots/audit-20-metrics.png';
import auditViolationCriticalScreenshot from '~/assets/screenshots/audit-violation-critical.png';
import auditRemediationEffortScreenshot from '~/assets/screenshots/audit-remediation-effort.png';
---

<MainLayout
	title="Audit d'Architecture"
	description="À chaque build, HexaGlue mesure la conformité de votre architecture DDD et hexagonale. Score objectif, violations localisées, estimation de remédiation."
	schema={{
		"@type": "TechArticle",
		proficiencyLevel: "Beginner",
		about: [
			{ "@type": "Thing", name: "Audit d'architecture logicielle" },
			{ "@type": "Thing", name: "Architecture hexagonale" },
			{ "@type": "Thing", name: "Domain-Driven Design" },
		],
	}}
>
	<!-- Hero Section -->
	<section class="pt-24 pb-16 md:pt-32 md:pb-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<GreenishStardust height="h-64 md:h-80" />

		<div class="text-center max-w-3xl mx-auto">
			<span class="bg-clip-text text-transparent bg-blue-green-gradient font-semibold text-sm uppercase tracking-wider">
				Audit
			</span>

			<h1 class="mt-4 font-heading heading-bold text-4xl md:text-5xl lg:text-6xl text-white text-balance">
				L'architecture se mesure.<br/>
				<span class="bg-clip-text text-transparent bg-blue-green-gradient">Pas à l'intuition. Par les données.</span>
			</h1>

			<p class="mt-6 text-lg text-astro-gray-200 font-light max-w-2xl mx-auto text-balance">
				HexaGlue audite automatiquement la conformité de votre architecture DDD et hexagonale. Un score objectif, des écarts localisés, une estimation de l'effort de correction. Le tout intégré à votre pipeline CI/CD.
			</p>
		</div>
	</section>

	<div class="relative z-[15] w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<CompanionBanner variant="features" href="/docs/plugin-audit/" />
	</div>

	<!-- Section 1 : Le problème -->
	<section class="py-16 md:py-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<SectionCopy
			label="Constat"
			title="L'architecture se dégrade en silence"
		>
			L'architecture d'un projet ne casse pas d'un coup. Elle se dégrade commit après commit : un raccourci ici, une dépendance mal orientée là, un concept métier qui fuit dans l'infrastructure. Quand les symptômes deviennent visibles (tests fragiles, refactoring risqué, onboarding lent), la dette technique est déjà installée.<br><br>
			Sans mesure objective, l'état de l'architecture reste une impression. Chaque développeur a son opinion, chaque revue de code ses angles morts. Les décisions se prennent sans données.
		</SectionCopy>

		<div class="max-w-4xl mx-auto">
			<Insight variant="amber">
				<p>L'audit HexaGlue remplace les impressions par des mesures. À chaque build, il analyse le code source et produit un diagnostic : un score, des écarts précis, et une estimation de l'effort nécessaire pour corriger. C'est un outil de pilotage autant qu'un outil de développement.</p>
			</Insight>
		</div>

		<BrowserFrame class="mt-10" caption="Un score, un grade, un statut. Un verdict clair et précis." scale={90}>
			<Image
				src={auditVerdictWithBlockerScreenshot}
				alt="Verdict d'audit HexaGlue : score 13/100, grade F, statut Failed sur fond rouge"
				widths={[400, 600, 800, 1200]}
				sizes="(max-width: 768px) 100vw, 56rem"
				loading="lazy"
			/>
		</BrowserFrame>
	</section>

	<!-- Section 2 : Un score objectif -->
	<section class="py-16 md:py-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<SectionCopy
			label="Score"
			title="Un diagnostic en 5 dimensions"
		>
			Le score d'audit condense l'état de votre architecture en un chiffre de 0 à 100, décomposé en 5 dimensions. Chaque dimension répond à une question concrète sur la santé de votre projet.
		</SectionCopy>

		<div class="mt-10 max-w-4xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<div class="p-2 rounded-lg bg-blue-green-gradient/10 text-astro-green">
						<Icon name="hexaglue/aggregate" class="size-5" aria-hidden="true" />
					</div>
					<h3 class="text-white font-semibold">Conformité DDD</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Vos concepts métier sont-ils correctement modélisés ? Agrégats cohérents, value objects immuables, identités typées.</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<div class="p-2 rounded-lg bg-blue-green-gradient/10 text-astro-green">
						<Icon name="hexaglue/validation" class="size-5" aria-hidden="true" />
					</div>
					<h3 class="text-white font-semibold">Architecture hexagonale</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Les couches sont-elles bien isolées ? Ports définis comme interfaces, adapters indépendants, domaine protégé.</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<div class="p-2 rounded-lg bg-blue-green-gradient/10 text-astro-green">
						<Icon name="ri:arrow-right-line" class="size-5" aria-hidden="true" />
					</div>
					<h3 class="text-white font-semibold">Dépendances</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Les dépendances vont-elles dans le bon sens ? L'infrastructure dépend du domaine, jamais l'inverse.</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<div class="p-2 rounded-lg bg-blue-green-gradient/10 text-astro-green">
						<Icon name="ri:link" class="size-5" aria-hidden="true" />
					</div>
					<h3 class="text-white font-semibold">Couplage</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Vos composants sont-ils indépendants ? Un changement dans un module ne devrait pas en impacter dix autres.</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<div class="p-2 rounded-lg bg-blue-green-gradient/10 text-astro-green">
						<Icon name="ri:layout-masonry-line" class="size-5" aria-hidden="true" />
					</div>
					<h3 class="text-white font-semibold">Cohésion</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Les concepts liés sont-ils regroupés ? Un agrégat et ses value objects doivent cohabiter, pas être dispersés.</p>
			</div>
		</div>

		<div class="max-w-4xl mx-auto">
			<Insight variant="amber">
				<p>Le score n'est pas une note scolaire : c'est un indicateur de tendance. Un projet legacy démarre typiquement entre 10 et 20/100. Un projet bien structuré atteint 60 à 80. L'objectif n'est pas 100 : c'est la progression régulière qui compte, visible build après build.</p>
			</Insight>
		</div>

		<BrowserFrame class="mt-10" caption="Où perdez-vous des points ?">
			<Image
				src={auditKpiTableScreenshot}
				alt="Tableau KPI du rapport d'audit HexaGlue : 5 dimensions avec statuts On Target, At Risk et Below Target"
				widths={[400, 600, 800, 1200]}
				sizes="(max-width: 768px) 100vw, 56rem"
				loading="lazy"
			/>
		</BrowserFrame>

		<BrowserFrame class="mt-10" caption="La cible vs la réalité, en un coup d'oeil" scale={60}>
			<Image
				src={auditRadarChartScreenshot}
				alt="Radar chart du rapport d'audit HexaGlue : superposition du seuil cible et du score actuel sur 5 axes"
				widths={[400, 600, 800, 1200]}
				sizes="(max-width: 768px) 100vw, 56rem"
				loading="lazy"
			/>
		</BrowserFrame>
	</section>

	<!-- Section 3 : Violations -->
	<section class="py-16 md:py-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<SectionCopy
			label="Violations"
			title="Chaque écart est localisé, expliqué, priorisé"
		>
			L'audit ne se contente pas d'un score global. Il identifie chaque écart par rapport aux principes DDD et hexagonaux, regroupé par thème : la classe concernée, la règle enfreinte, l'impact sur l'architecture, et un correctif illustré par un exemple de code.
		</SectionCopy>

		<div class="mt-10 max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-4">
			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<div class="p-2 rounded-lg bg-blue-green-gradient/10 text-astro-green">
						<Icon name="ri:shield-check-line" class="size-5" aria-hidden="true" />
					</div>
					<h3 class="text-white font-semibold">15 contraintes vérifiées</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">8 contraintes DDD (cycles entre agrégats, identité des entités, immuabilité des value objects, pureté du domaine...) et 7 contraintes hexagonales (direction des dépendances, isolation des couches, couverture des ports...). Le <a href="/docs/plugin-audit/">catalogue complet</a> est dans la documentation.</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<div class="p-2 rounded-lg bg-blue-green-gradient/10 text-astro-green">
						<Icon name="ri:sort-desc" class="size-5" aria-hidden="true" />
					</div>
					<h3 class="text-white font-semibold">4 niveaux de sévérité</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Chaque violation est classée de BLOCKER (bloque le build, non négociable) à MINOR (suggestion d'amélioration). Les niveaux BLOCKER et CRITICAL sont <a href="/docs/plugin-audit/">configurables</a> pour adapter la rigueur à la maturité de votre projet.</p>
			</div>
		</div>

		<div class="max-w-4xl mx-auto">
			<Insight variant="green">
				<p>Chaque violation est accompagnée d'une explication, d'un correctif illustré par un exemple de code et d'un chiffrage de l'effort. L'ensemble crée un plan d'actions clair, précis et actionnable.</p>
			</Insight>
		</div>

		<BrowserFrame class="mt-10" caption="Un problème, une action claire">
			<Image
				src={auditViolationCriticalScreenshot}
				alt="Violation CRITICAL dans un rapport d'audit HexaGlue : Mutable Value Object avec correctif proposé en record Java"
				widths={[400, 600, 800, 1200]}
				sizes="(max-width: 768px) 100vw, 56rem"
				loading="lazy"
			/>
		</BrowserFrame>
	</section>

	<!-- Section 4 : Plan de remédiation -->
	<section class="py-16 md:py-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<SectionCopy
			label="Remédiation"
			title="Un plan d'action chiffré, pas une liste de souhaits"
		>
			L'audit ne s'arrête pas au diagnostic. Il produit un plan de remédiation consolidé : chaque action est priorisée par sévérité, chiffrée en jours d'effort, et comparée entre correction manuelle et génération automatique par HexaGlue. L'équipe sait exactement quoi faire, dans quel ordre, et combien ça coûte.
		</SectionCopy>

		<div class="max-w-4xl mx-auto">
			<Insight variant="green">
				<p>L'estimation compare l'effort manuel et l'effort automatisable, chiffrés en jours et en euros. Par exemple, retirer les annotations JPA d'un domaine est un travail manuel, mais régénérer toute la couche persistence correspondante peut être automatisé par le plugin JPA d'HexaGlue. Le rapport affiche le coût de chaque approche et les économies réalisables.</p>
			</Insight>
		</div>

		<BrowserFrame class="mt-10" caption="Un plan de remédiation consolidé et chiffré">
			<Image
				src={auditRemediationEffortScreenshot}
				alt="Bandeau estimation de remédiation HexaGlue : comparaison effort manuel vs automatisable avec coûts en EUR"
				widths={[400, 600, 800, 1200]}
				sizes="(max-width: 768px) 100vw, 56rem"
				loading="lazy"
			/>
		</BrowserFrame>
	</section>

	<!-- Section 5 : Métriques -->
	<section class="py-16 md:py-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<SectionCopy
			label="Métriques"
			title="20 indicateurs pour piloter l'amélioration"
		>
			Les violations montrent ce qui ne va pas. Les métriques montrent où en est votre architecture : 20 indicateurs quantitatifs, répartis en 6 catégories, mesurent la santé structurelle de votre projet build après build.
		</SectionCopy>

		<div class="mt-10 max-w-4xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">1</span>
					<h3 class="text-white font-semibold">Domain-Driven Design</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Couverture du domaine, pureté des types, ratio value objects, couverture événementielle, couplage entre agrégats</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">2</span>
					<h3 class="text-white font-semibold">Design des agrégats</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Taille moyenne, respect des frontières, cohésion interne, stabilité</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">3</span>
					<h3 class="text-white font-semibold">Architecture hexagonale</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Couverture des ports repository, indépendance des adapters</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">4</span>
					<h3 class="text-white font-semibold">Qualité du code</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Complexité cyclomatique, taux de code boilerplate dans le domaine</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">5</span>
					<h3 class="text-white font-semibold">Modularité</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Coût de propagation, cyclicité, profondeur des dépendances, fan-out, visibilité, index de maturité modulaire</p>
			</div>

			<div class="p-5 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
				<div class="flex items-center gap-3 mb-3">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">6</span>
					<h3 class="text-white font-semibold">Stabilité des packages</h3>
				</div>
				<p class="text-sm text-astro-gray-200 font-light">Couplage afférent et efférent, instabilité, abstraction, distance à la Main Sequence</p>
			</div>
		</div>

		<div class="max-w-4xl mx-auto">
			<Insight variant="amber">
				<p>Chaque métrique a un seuil d'alerte intégré. Quand sa valeur est dépassée, elle apparaît en rouge dans le rapport afin de guider les équipes dans l'amélioration continue de leur application.</p>
			</Insight>
		</div>

		<BrowserFrame class="mt-10" caption="20 métriques quantitatives pour objectiver la qualité architecturale" scale={90}>
			<Image
				src={audit20MetricsScreenshot}
				alt="Tableau des 20 métriques d'audit HexaGlue : couplage, cohésion, complexité, couverture DDD, avec seuils et statuts"
				widths={[400, 600, 800, 1200]}
				sizes="(max-width: 768px) 100vw, 56rem"
				loading="lazy"
			/>
		</BrowserFrame>
	</section>

	<!-- Section 6 : Le rapport -->
	<section class="py-16 md:py-20 relative w-full max-w-screen-xl mx-auto px-4 sm:px-8">
		<SectionCopy
			label="Rapport"
			title="Un rapport lisible par toute l'équipe"
		>
			Le rapport d'audit est conçu pour être partagé : avec l'équipe de développement pour prioriser les corrections, avec le management pour suivre l'évolution de la dette technique. Il contient 5 sections, du verdict synthétique au plan de remédiation chiffré.
		</SectionCopy>

		<div class="mt-10 max-w-4xl mx-auto">
			<Image
				src={auditScreenshot}
				alt="Vue d'ensemble d'un rapport d'audit HexaGlue : verdict, inventaire, violations, métriques et estimation de remédiation"
				widths={[400, 600, 800, 1200]}
				sizes="(max-width: 768px) 100vw, 56rem"
				class="w-full rounded-xl border border-astro-dark-100/15 shadow-2xl"
				loading="lazy"
			/>
		</div>

		<div class="mt-10 max-w-4xl mx-auto">
			<ol class="space-y-4">
				<li class="flex items-start gap-3 p-4 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">1</span>
					<div>
						<h3 class="text-white font-semibold">Verdict</h3>
						<p class="text-sm text-astro-gray-200 font-light">Score global, grade (A à F), statut pass/fail, décomposition KPI sur 5 dimensions avec radar de conformité</p>
					</div>
				</li>
				<li class="flex items-start gap-3 p-4 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">2</span>
					<div>
						<h3 class="text-white font-semibold">Cartographie de l'architecture</h3>
						<p class="text-sm text-astro-gray-200 font-light">Inventaire des types par rôle (agrégats, entités, value objects, ports...) et 5 diagrammes générés automatiquement : C4 System Context, C4 Component, modèle du domaine, couche des ports, vue d'ensemble</p>
					</div>
				</li>
				<li class="flex items-start gap-3 p-4 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">3</span>
					<div>
						<h3 class="text-white font-semibold">Violations détectées</h3>
						<p class="text-sm text-astro-gray-200 font-light">Écarts groupés par thème (DDD, Ports & Adapters...), avec localisation, impact, sévérité et exemples de code pour le correctif</p>
					</div>
				</li>
				<li class="flex items-start gap-3 p-4 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">4</span>
					<div>
						<h3 class="text-white font-semibold">Plan de remédiation</h3>
						<p class="text-sm text-astro-gray-200 font-light">Actions priorisées avec estimation chiffrée : effort manuel en jours, effort automatisable par HexaGlue, comparaison en euros et économies réalisées</p>
					</div>
				</li>
				<li class="flex items-start gap-3 p-4 bg-astro-dark-800/40 border border-astro-dark-100/15 rounded-xl">
					<span class="shrink-0 size-7 flex items-center justify-center rounded-full bg-blue-green-gradient text-white text-sm font-semibold">5</span>
					<div>
						<h3 class="text-white font-semibold">Annexe technique</h3>
						<p class="text-sm text-astro-gray-200 font-light">20 métriques de santé architecturale (DDD, hexagonal, qualité, modularité...) et stabilité des packages (couplage, instabilité, distance à la Main Sequence)</p>
					</div>
				</li>
			</ol>
		</div>
	</section>

	<!-- CTA Final -->
	<section class="py-16 md:py-24 mb-12 relative">
		<div class="w-full max-w-screen-xl mx-auto px-4 sm:px-8 text-center space-y-6">
			<h2 class="font-heading heading-bold text-3xl md:text-4xl lg:text-5xl text-white">
				<span class="text-astro-gray-300">Votre architecture a besoin d'un diagnostic objectif.</span><br/>
				Lancez votre premier audit.
			</h2>

			<p class="text-xl text-astro-gray-200 font-light max-w-2xl mx-auto">
				L'étude de cas e-commerce montre l'audit en action : du diagnostic initial à l'architecture cible.
			</p>

			<div class="pt-4 flex flex-col sm:flex-row items-center justify-center gap-4">
				<Link href="/case-studies/ecommerce-migration/step-1-discovery/" class="primary">
					Interpréter un rapport d'audit
				</Link>
				<Link href="/docs/plugin-audit/" class="secondary">
					<Icon name="ri:settings-3-line" class="size-5" aria-hidden="true" />
					<span>Configurer l'audit</span>
				</Link>
			</div>
		</div>
		<div
			class="absolute inset-x-0 bottom-0 h-[50vw] translate-y-[60%] bg-blue-green-gradient opacity-50 mask-radial-gradient pointer-events-none"
		></div>
	</section>
</MainLayout>

<style>
	code {
		@apply px-1.5 py-0.5 bg-astro-dark-600 rounded text-xs text-astro-gray-100;
		font-family: 'JetBrains Mono', ui-monospace, monospace;
	}
</style>
